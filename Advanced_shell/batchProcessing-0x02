#!/bin/bash

retry() {
  local url=$1
  local output=$2
  local name=$3

  for i in {1..3}; do
    echo "Attempt $i to fetch $name..."
    curl -s -o "$output" --fail "$url" && return 0
    sleep 1
  done
  echo "Failed to fetch $name after 3 attempts" >> errors.txt
  return 1
}

mkdir -p pokemon_data
pokemon_list=(bulbasaur ivysaur venusaur charmander charmeleon)

for pokemon in "${pokemon_list[@]}"; do
  retry "https://pokeapi.co/api/v2/pokemon/$pokemon" "pokemon_data/$pokemon.json" "$pokemon" &&
  echo "Saved data to pokemon_data/$pokemon.json"
done
